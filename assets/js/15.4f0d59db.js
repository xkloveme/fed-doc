(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{218:function(v,_,t){"use strict";t.r(_);var d=t(0),r=Object(d.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"杭州办公网公网端口映射"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#杭州办公网公网端口映射","aria-hidden":"true"}},[v._v("#")]),v._v(" 杭州办公网公网端口映射")]),v._v(" "),t("h2",{attrs:{id:"一、端口映射表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、端口映射表","aria-hidden":"true"}},[v._v("#")]),v._v(" 一、端口映射表")]),v._v(" "),t("p",[v._v("杭州办公网固件IP为112.17.116.161，可将部分测试项目部署在内部服务器上，通过端口映射对外提供服务，方便通过公网访问。")]),v._v(" "),t("h3",{attrs:{id:"前端项目映射表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前端项目映射表","aria-hidden":"true"}},[v._v("#")]),v._v(" 前端项目映射表")]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("公网端口")]),v._v(" "),t("th",[v._v("内网地址")]),v._v(" "),t("th",[v._v("项目说明")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("7000")]),v._v(" "),t("td",[v._v("10.1.1.6:3100")]),v._v(" "),t("td",[v._v("hekr-components")])]),v._v(" "),t("tr",[t("td",[v._v("7001")]),v._v(" "),t("td",[v._v("10.10.1.2:7001")]),v._v(" "),t("td",[v._v("恒大酒店")])]),v._v(" "),t("tr",[t("td",[v._v("7002")]),v._v(" "),t("td",[v._v("10.10.1.2:7002")]),v._v(" "),t("td",[v._v("海顿新风")])]),v._v(" "),t("tr",[t("td",[v._v("7003")]),v._v(" "),t("td",[v._v("10.10.1.2:7003")]),v._v(" "),t("td",[v._v("东陈default-托马仕新风-无租赁共享版")])]),v._v(" "),t("tr",[t("td",[v._v("7004")]),v._v(" "),t("td",[v._v("10.10.1.2:7004")]),v._v(" "),t("td",[v._v("美埃静态")])]),v._v(" "),t("tr",[t("td",[v._v("7005")]),v._v(" "),t("td",[v._v("10.10.1.2:7005")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7006")]),v._v(" "),t("td",[v._v("10.10.1.2:7006")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7007")]),v._v(" "),t("td",[v._v("10.10.1.2:7007")]),v._v(" "),t("td",[v._v("东陈dx-托马仕新风-租赁共享版")])]),v._v(" "),t("tr",[t("td",[v._v("7008")]),v._v(" "),t("td",[v._v("10.10.1.2:7008")]),v._v(" "),t("td",[v._v("美埃动态")])]),v._v(" "),t("tr",[t("td",[v._v("7009")]),v._v(" "),t("td",[v._v("10.10.1.2:7009")]),v._v(" "),t("td",[v._v("江苏消防dx")])]),v._v(" "),t("tr",[t("td",[v._v("7010")]),v._v(" "),t("td",[v._v("10.10.1.2:7010")]),v._v(" "),t("td",[v._v("安德盛威美容仪")])]),v._v(" "),t("tr",[t("td",[v._v("7011")]),v._v(" "),t("td",[v._v("10.10.1.2:7011")]),v._v(" "),t("td",[v._v("数源充电桩")])]),v._v(" "),t("tr",[t("td",[v._v("7012")]),v._v(" "),t("td",[v._v("10.10.1.2:7012")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7013")]),v._v(" "),t("td",[v._v("10.10.1.2:7013")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7014")]),v._v(" "),t("td",[v._v("10.10.1.2:7014")]),v._v(" "),t("td",[v._v("托马斯")])]),v._v(" "),t("tr",[t("td",[v._v("7015")]),v._v(" "),t("td",[v._v("10.10.1.2:7015")]),v._v(" "),t("td",[v._v("焕颜")])]),v._v(" "),t("tr",[t("td",[v._v("7016")]),v._v(" "),t("td",[v._v("10.10.1.2:7016")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7017")]),v._v(" "),t("td",[v._v("10.10.1.2:7017")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7018")]),v._v(" "),t("td",[v._v("10.10.1.2:7018")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7019")]),v._v(" "),t("td",[v._v("10.10.1.2:7019")]),v._v(" "),t("td",[v._v("海水湾")])]),v._v(" "),t("tr",[t("td",[v._v("7020")]),v._v(" "),t("td",[v._v("10.10.1.2:7020")]),v._v(" "),t("td",[v._v("新版共享租赁")])]),v._v(" "),t("tr",[t("td",[v._v("7021")]),v._v(" "),t("td",[v._v("10.10.1.2:7021")]),v._v(" "),t("td",[v._v("金控")])]),v._v(" "),t("tr",[t("td",[v._v("7022")]),v._v(" "),t("td",[v._v("10.10.1.2:7022")]),v._v(" "),t("td",[v._v("同欣")])]),v._v(" "),t("tr",[t("td",[v._v("7023")]),v._v(" "),t("td",[v._v("10.10.1.2:7023")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7024")]),v._v(" "),t("td",[v._v("10.10.1.2:7024")]),v._v(" "),t("td",[v._v("中科城安")])]),v._v(" "),t("tr",[t("td",[v._v("7025")]),v._v(" "),t("td",[v._v("10.10.1.2:7025")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7026")]),v._v(" "),t("td",[v._v("10.10.1.2:7026")]),v._v(" "),t("td",[v._v("飞繁web")])]),v._v(" "),t("tr",[t("td",[v._v("7027")]),v._v(" "),t("td",[v._v("10.10.1.2:7027")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7028")]),v._v(" "),t("td",[v._v("10.10.1.2:7028")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7029")]),v._v(" "),t("td",[v._v("10.10.1.2:7029")]),v._v(" "),t("td",[v._v("紫光新锐")])]),v._v(" "),t("tr",[t("td",[v._v("7030")]),v._v(" "),t("td",[v._v("10.10.1.2:7030")]),v._v(" "),t("td",[v._v("雷弗web")])]),v._v(" "),t("tr",[t("td",[v._v("7031")]),v._v(" "),t("td",[v._v("10.10.1.2:7031")]),v._v(" "),t("td",[v._v("曼瑞德")])]),v._v(" "),t("tr",[t("td",[v._v("7032")]),v._v(" "),t("td",[v._v("10.10.1.2:7032")]),v._v(" "),t("td",[v._v("禹成")])]),v._v(" "),t("tr",[t("td",[v._v("7033")]),v._v(" "),t("td",[v._v("10.10.1.2:7033")]),v._v(" "),t("td",[v._v("雷弗引导页")])]),v._v(" "),t("tr",[t("td",[v._v("7034")]),v._v(" "),t("td",[v._v("10.10.1.2:7034")]),v._v(" "),t("td",[v._v("飞繁wechat")])]),v._v(" "),t("tr",[t("td",[v._v("7035")]),v._v(" "),t("td",[v._v("10.10.1.2:7035")]),v._v(" "),t("td",[v._v("行业demo")])]),v._v(" "),t("tr",[t("td",[v._v("7036")]),v._v(" "),t("td",[v._v("10.10.1.2:7036")]),v._v(" "),t("td",[v._v("中消恒安")])]),v._v(" "),t("tr",[t("td",[v._v("7037")]),v._v(" "),t("td",[v._v("10.10.1.2:7037")]),v._v(" "),t("td",[v._v("中科纳清")])]),v._v(" "),t("tr",[t("td",[v._v("7038")]),v._v(" "),t("td",[v._v("10.10.1.2:7038")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7039")]),v._v(" "),t("td",[v._v("10.10.1.2:7039")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7040")]),v._v(" "),t("td",[v._v("10.10.1.2:7040")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7041")]),v._v(" "),t("td",[v._v("10.10.1.2:7041")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7042")]),v._v(" "),t("td",[v._v("10.10.1.2:7042")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7043")]),v._v(" "),t("td",[v._v("10.10.1.2:7043")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7044")]),v._v(" "),t("td",[v._v("10.10.1.2:7044")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7045")]),v._v(" "),t("td",[v._v("10.10.1.2:7045")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7046")]),v._v(" "),t("td",[v._v("10.10.1.2:7046")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7047")]),v._v(" "),t("td",[v._v("10.10.1.2:7047")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7048")]),v._v(" "),t("td",[v._v("10.10.1.2:7048")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7049")]),v._v(" "),t("td",[v._v("10.10.1.2:7049")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7050")]),v._v(" "),t("td",[v._v("10.10.1.2:7050")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7051")]),v._v(" "),t("td",[v._v("10.10.1.2:7051")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7052")]),v._v(" "),t("td",[v._v("10.10.1.2:7052")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7053")]),v._v(" "),t("td",[v._v("10.10.1.2:7053")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7054")]),v._v(" "),t("td",[v._v("10.10.1.2:7054")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7055")]),v._v(" "),t("td",[v._v("10.10.1.2:7055")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7056")]),v._v(" "),t("td",[v._v("10.10.1.2:7056")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7057")]),v._v(" "),t("td",[v._v("10.10.1.2:7057")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7058")]),v._v(" "),t("td",[v._v("10.10.1.2:7058")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7059")]),v._v(" "),t("td",[v._v("10.10.1.2:7059")]),v._v(" "),t("td")]),v._v(" "),t("tr",[t("td",[v._v("7060")]),v._v(" "),t("td",[v._v("10.10.1.2:7060")]),v._v(" "),t("td")])])]),v._v(" "),t("h3",{attrs:{id:"后端项目映射表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#后端项目映射表","aria-hidden":"true"}},[v._v("#")]),v._v(" 后端项目映射表")]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("公网端口")]),v._v(" "),t("th",[v._v("内网地址")]),v._v(" "),t("th",[v._v("项目说明")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("10888")]),v._v(" "),t("td",[v._v("10.10.1.2:3000")]),v._v(" "),t("td",[v._v("console web front")])]),v._v(" "),t("tr",[t("td",[v._v("10882")]),v._v(" "),t("td",[v._v("10.10.1.2:18082 -> 10.10.1.4:8082")]),v._v(" "),t("td",[v._v('webapi，"->"表示通过nginx做了跨域转发，下同')])]),v._v(" "),t("tr",[t("td",[v._v("10880")]),v._v(" "),t("td",[v._v("10.10.1.2:18080 -> 10.10.1.4:8080")]),v._v(" "),t("td",[v._v("console")])]),v._v(" "),t("tr",[t("td",[v._v("10800")]),v._v(" "),t("td",[v._v("10.10.1.2:18000 -> 10.10.1.5:8000")]),v._v(" "),t("td",[v._v("uaa")])]),v._v(" "),t("tr",[t("td",[v._v("10895")]),v._v(" "),t("td",[v._v("10.10.1.2:18095 -> 10.10.1.5:8095")]),v._v(" "),t("td",[v._v("fire")])]),v._v(" "),t("tr",[t("td",[v._v("10892")]),v._v(" "),t("td",[v._v("10.10.1.2:8092")]),v._v(" "),t("td",[v._v("nbiot")])]),v._v(" "),t("tr",[t("td",[v._v("10801")]),v._v(" "),t("td",[v._v("10.10.1.2:9002")]),v._v(" "),t("td",[v._v("飞繁")])]),v._v(" "),t("tr",[t("td",[v._v("10802")]),v._v(" "),t("td",[v._v("10.10.1.2:9004")]),v._v(" "),t("td",[v._v("雷弗")])]),v._v(" "),t("tr",[t("td",[v._v("10083")]),v._v(" "),t("td",[v._v("10.10.1.4:83")]),v._v(" "),t("td",[v._v("connect device tcp")])]),v._v(" "),t("tr",[t("td",[v._v("10084")]),v._v(" "),t("td",[v._v("10.10.1.4:84")]),v._v(" "),t("td",[v._v("connect device web")])]),v._v(" "),t("tr",[t("td",[v._v("10085")]),v._v(" "),t("td",[v._v("10.10.1.4:85")]),v._v(" "),t("td",[v._v("connect app tcp")])]),v._v(" "),t("tr",[t("td",[v._v("10086")]),v._v(" "),t("td",[v._v("10.10.1.4:86")]),v._v(" "),t("td",[v._v("connect app websocket")])]),v._v(" "),t("tr",[t("td",[v._v("10087")]),v._v(" "),t("td",[v._v("10.10.1.4:87")]),v._v(" "),t("td",[v._v("connect 48 tcp")])]),v._v(" "),t("tr",[t("td",[v._v("10088")]),v._v(" "),t("td",[v._v("10.10.1.4:88")]),v._v(" "),t("td",[v._v("connect 48 websocket")])]),v._v(" "),t("tr",[t("td",[v._v("10093")]),v._v(" "),t("td",[v._v("10.10.1.4:93")]),v._v(" "),t("td",[v._v("connect 48v2 tcp")])]),v._v(" "),t("tr",[t("td",[v._v("10094")]),v._v(" "),t("td",[v._v("10.10.1.4:94")]),v._v(" "),t("td",[v._v("connect 48v2 websocket")])]),v._v(" "),t("tr",[t("td",[v._v("10193")]),v._v(" "),t("td",[v._v("10.10.1.4:193")]),v._v(" "),t("td",[v._v("connect 48v2 ssl tcp")])]),v._v(" "),t("tr",[t("td",[v._v("10194")]),v._v(" "),t("td",[v._v("10.10.1.4:194")]),v._v(" "),t("td",[v._v("connect 48v2 ssl websocket")])])])]),v._v(" "),t("h3",{attrs:{id:"其它映射表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其它映射表","aria-hidden":"true"}},[v._v("#")]),v._v(" 其它映射表")]),v._v(" "),t("p",[t("em",[t("strong",[v._v("迪文充电桩平台")])]),v._v("\n71xx 预留给充电桩使用，包括前后端，但不包括数源")]),v._v(" "),t("table",[t("thead",[t("tr",[t("th",[v._v("公网端口")]),v._v(" "),t("th",[v._v("内网地址")]),v._v(" "),t("th",[v._v("项目说明")])])]),v._v(" "),t("tbody",[t("tr",[t("td",[v._v("7100")]),v._v(" "),t("td",[v._v("10.10.1.2:7100")]),v._v(" "),t("td",[v._v("web console")])]),v._v(" "),t("tr",[t("td",[v._v("7101")]),v._v(" "),t("td",[v._v("10.10.1.3:7101 -> 10.10.1.3:3501")]),v._v(" "),t("td",[v._v("uaa #跨域转发")])]),v._v(" "),t("tr",[t("td",[v._v("7102")]),v._v(" "),t("td",[v._v("10.10.1.3:7102 -> 10.10.1.3:3502")]),v._v(" "),t("td",[v._v("webapi")])])])]),v._v(" "),t("h2",{attrs:{id:"二、前端项目如何部署在10-10-1-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、前端项目如何部署在10-10-1-2","aria-hidden":"true"}},[v._v("#")]),v._v(" 二、前端项目如何部署在10.10.1.2")]),v._v(" "),t("p",[v._v("目前后端有三套环境，生产环境，预发环境，杭州开发环境。如果需要调用后端的开发环境，可以考虑将前端也部署在杭州开发环境。其它情况，如调用生产环境或者预发环境，或者静态演示系统，尽量部署在oss上，即以http://hy.hekr.me/xxx形式进行访问。")]),v._v(" "),t("p",[v._v("下文以部署海水湾web为例进行部署说明")]),v._v(" "),t("h3",{attrs:{id:"_2-1-配置nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-配置nginx","aria-hidden":"true"}},[v._v("#")]),v._v(" 2.1. 配置nginx")]),v._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("#登录10.10.1.2，用户名和密码找管理员分配\nssh zeyang.li@10.10.1.2\n\n#新建web根目录\n#注意，统一放在/data/www下，文件名规范xxx-web格式\nsudo -u gitlab-runner mkdir /data/www/haisw-web\n\n#进入nginx配置目录\ncd /usr/local/openresty/nginx/conf/conf.d\n\n#ls查看目录端口增长到哪了，行业web项目端口号限定在70xx内，\n#例如目前最大的为7038.custom.hekrxiaofang-web.conf，可考虑使用7039端口\nls\nsudo cp 7001.custom.hengda-web.conf 7039.custom.haisw-web.conf\n\n#修改7039.custom.haisw-web.conf中的listen、root为相应的端口号和web根目录\nsudo vim 7039.custom.haisw-web.conf\n\n#重启nginx\nsudo /usr/local/openresty/nginx/sbin/nginx -s reload\n")])])]),t("h3",{attrs:{id:"_2-2-配置gitlab-ci"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-配置gitlab-ci","aria-hidden":"true"}},[v._v("#")]),v._v(" 2.2. 配置gitlab ci")]),v._v(" "),t("p",[v._v("源码保存在gitlab上，不直接复制至10.10.1.2上，防止服务器故障源码丢失。")]),v._v(" "),t("ol",[t("li",[t("p",[v._v("打开runner\n进入gitlab的项目主页， "),t("em",[t("strong",[v._v("settings")])]),v._v(" -> "),t("em",[t("strong",[v._v("CI/CD")])]),v._v(" ，打开Runners settings，找到 "),t("em",[t("strong",[v._v("hz-test")])]),v._v(' ，点击对应的"Enable for this project"。')])]),v._v(" "),t("li",[t("p",[v._v('源代码根目录下，新建".gitlab-ci.yml"文件，内容如下')])])]),v._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[v._v("cache:\n  paths:\n  - node_modules/\n\n部署到杭州办公测试环境:\n  script:\n    - npm install --registry=http://npm.hekr.me/\n#打包命令和目录根据情况进行调整\n    - npm run build:test\n    - rm -rf /data/www/haisw-web/*\n    - cp -R dist/* /data/www/haisw-web/\n  tags:\n    - hz-test\n  only:\n    - master\n  when: always  #可根据情况改成always或者manual。always表示提交即自动部署，manual表示提交后需要手动点击进行部署\n  environment:\n    name: 112.17.116.161\n    url: http://112.17.116.161:7039/   #端口号要调整\n\n")])])]),t("p",[v._v("保存文件并提交，可在 "),t("em",[t("strong",[v._v("CI/CD")])]),v._v(" -> "),t("em",[t("strong",[v._v("Pipelines")])]),v._v(" 查看部署详情情况，若一切无问题，可访问进行验证。内网地址为 "),t("em",[t("strong",[v._v("http://10.10.1.2:7039")])]),v._v(" ，外网地址为 "),t("em",[t("strong",[v._v("http://112.17.116.161:7039")])])])])}),[],!1,null,null,null);_.default=r.exports}}]);