(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{229:function(t,a,s){"use strict";s.r(a);var e=s(0),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"维消宝换皮相关流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#维消宝换皮相关流程","aria-hidden":"true"}},[t._v("#")]),t._v(" 维消宝换皮相关流程")]),t._v(" "),s("blockquote",[s("p",[t._v("为了更快接触了解维消宝项目换皮相关流程")])]),t._v(" "),s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("重要")]),t._v(" "),s("p",[t._v("我们在换皮项目时一律用"),s("kbd",[t._v("fork")]),t._v("方式，虽然比新建分支过程麻烦一点，但不至于污染主仓库代码")])]),t._v(" "),s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#维消宝换皮相关流程"}},[t._v("维消宝换皮相关流程")]),s("ul",[s("li",[s("a",{attrs:{href:"#起步"}},[t._v("起步")])]),s("li",[s("a",{attrs:{href:"#fork-项目"}},[t._v("fork 项目")])]),s("li",[s("a",{attrs:{href:"#clone-项目"}},[t._v("clone 项目")])])])])])]),s("p"),t._v(" "),s("h2",{attrs:{id:"起步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#起步","aria-hidden":"true"}},[t._v("#")]),t._v(" 起步")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("初衷")]),t._v(" "),s("p",[t._v("现在换皮流程比较混乱加之维消宝项目分支越来越多，导致"),s("code",[t._v(".git")]),t._v("文件很大"),s("kbd",[t._v("clone")]),t._v("时需要比较久的时间，特有此文档")])]),t._v(" "),s("h3",{attrs:{id:"项目的梳理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目的梳理","aria-hidden":"true"}},[t._v("#")]),t._v(" 项目的梳理")]),t._v(" "),s("p",[t._v("我们在登录"),s("code",[t._v("gitlab")]),t._v("后存在三种项目组")]),t._v(" "),s("ul",[s("li",[s("input",{attrs:{type:"checkbox",id:"checkbox62",checked:"true"}}),s("label",{attrs:{for:"checkbox62"}},[t._v("个人的项目")])]),t._v(" "),s("li",[s("input",{attrs:{type:"checkbox",id:"checkbox63",checked:"true"}}),s("label",{attrs:{for:"checkbox63"}},[t._v("行业解决方案")])]),t._v(" "),s("li",[s("input",{attrs:{type:"checkbox",id:"checkbox64",checked:"true"}}),s("label",{attrs:{for:"checkbox64"}},[t._v("氦氪一体化")])])]),t._v(" "),s("h2",{attrs:{id:"fork-项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fork-项目","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("code",[t._v("fork")]),t._v(" 项目")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("我们在维消宝项目中点击"),s("kbd",[t._v("派生")]),t._v(" "),s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EBz1Ag.png",alt:"EBz1Ag.png"}})])]),t._v(" "),s("li",[s("p",[t._v("选中"),s("code",[t._v("fork")]),t._v("到氦氪一体化\n"),s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EBzY3n.png",alt:"EBzY3n.png"}})])]),t._v(" "),s("li",[s("p",[t._v("删除多余分支只留"),s("code",[t._v("master")]),t._v("分支，删除多余标签\n"),s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EDSlKx.png",alt:"EDSlKx.png"}})])]),t._v(" "),s("li",[s("p",[t._v("更改库的名称和 "),s("code",[t._v("logo")]),t._v(" "),s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EDSC2n.png",alt:"EDSC2n.png"}}),t._v(" "),s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EDSkrV.png",alt:"EDSkrV.png"}})])]),t._v(" "),s("li",[s("p",[t._v("更改更为简洁的 ci，以明日电器为例：")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("cache:\n  paths:\n    - node_modules/\n\n部署到预发:\n  script:\n    - "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --registry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://npm.hekr.me\n    - "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:test\n    - "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" deploy.sh hekr-hangye/xiaofang-tomorrow-electrical-test/web\n  tags:\n    - "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n  only:\n    - master\n  when: manual\n  environment:\n    name: env-test\n    url: https://hy.hekr.me/xiaofang-tomorrow-electrical-test/web/index.html\n\n部署到线上:\n  script:\n    - "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --registry"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("http://npm.hekr.me\n    - "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:prod\n    - "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v(" deploy.sh hekr-hangye/xiaofang-tomorrow-electrical/web\n  tags:\n    - "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n  only:\n    - master\n  when: manual\n  environment:\n    name: env-prod\n    url: https://hy.hekr.me/xiaofang-tomorrow-electrical/web/index.html\n\n")])])]),s("h2",{attrs:{id:"clone-项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#clone-项目","aria-hidden":"true"}},[t._v("#")]),t._v(" "),s("code",[t._v("clone")]),t._v(" 项目")]),t._v(" "),s("ol",[s("li",[t._v("在克隆一份项目到本地")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone git@gitlab.hekr.me:web-app/weixiaobao-tomorrow-electrical.git\n")])])]),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("当并不需要进行深度克隆时可以添加参数")])]),t._v(" "),s("ul",[s("li",[t._v("最近五次提交")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone git@gitlab.hekr.me:web-app/weixiaobao-tomorrow-electrical.git --depth"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("\n")])])]),s("ul",[s("li",[t._v("单一"),s("code",[t._v("master")]),t._v("分支")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" clone git@gitlab.hekr.me:web-app/weixiaobao-tomorrow-electrical.git -b master --single-branch\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("添加远程"),s("code",[t._v("root")])])]),t._v(" "),s("blockquote",[s("p",[t._v("查看当前"),s("code",[t._v("remote")])])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote -v\n")])])]),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EDpDp9.png",alt:"EDpDp9.png"}})]),t._v(" "),s("blockquote",[s("p",[t._v("添加"),s("code",[t._v("root")]),t._v("源")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" remote "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" root git@gitlab.hekr.me:industry-solutions/xiaofang-web.git\n")])])]),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/EDp5pd.png",alt:"EDp5pd.png"}})]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("同步远程代码")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" fetch root master\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" merge root/master --no-f\n")])])]),s("p",[s("code",[t._v("--no-ff")]),t._v(" 指的是强行关闭 "),s("code",[t._v("fast-forward")]),t._v(" 方式")]),t._v(" "),s("p",[s("code",[t._v("fast-forward")]),t._v("方式就是当条件允许的时候，"),s("code",[t._v("git")]),t._v("直接把"),s("code",[t._v("HEAD")]),t._v("指针指向合并分支的头，完成合并。属于“快进方式”，不过这种情况如果删除分支，则会丢失分支信息。因为在这个过程中没有创建"),s("code",[t._v("commit")])]),t._v(" "),s("p",[s("code",[t._v("git merge --squash")]),t._v(" 是用来把一些不必要"),s("code",[t._v("commit")]),t._v("进行压缩，比如说，你的"),s("code",[t._v("feature")]),t._v("在开发的时候写的"),s("code",[t._v("commit")]),t._v("很乱，那么我们合并的时候不希望把这些历史"),s("code",[t._v("commit")]),t._v("带过来，于是使用"),s("code",[t._v("--squash")]),t._v("进行合并，此时文件已经同合并后一样了，但不移动 "),s("code",[t._v("HEAD")]),t._v("，不提交。需要进行一次额外的"),s("code",[t._v("commit")]),t._v("来“总结”一下，然后完成最终的合并")]),t._v(" "),s("p",[t._v("总结：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("--no-ff")]),t._v("：不使用 "),s("code",[t._v("fast-forward")]),t._v(" 方式合并，保留分支的 "),s("code",[t._v("commit")]),t._v(" 历史")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("--squash")]),t._v("：使用 "),s("code",[t._v("squash")]),t._v(" 方式合并，把多次分支 "),s("code",[t._v("commit")]),t._v(" 历史压缩为一次")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://s2.ax1x.com/2019/05/06/ED94ET.png",alt:"ED94ET.png"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);