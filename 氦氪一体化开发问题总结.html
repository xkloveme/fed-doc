<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>一体化项目前端开发常见问题汇总 | Fed-docs</title>
    <meta name="description" content="Hekr前端文档">
    
    
    <link rel="preload" href="/fed-doc/assets/css/0.styles.79df93a7.css" as="style"><link rel="preload" href="/fed-doc/assets/js/app.e912bd36.js" as="script"><link rel="preload" href="/fed-doc/assets/js/2.03965f8c.js" as="script"><link rel="preload" href="/fed-doc/assets/js/16.82f80a83.js" as="script"><link rel="prefetch" href="/fed-doc/assets/js/10.b8994720.js"><link rel="prefetch" href="/fed-doc/assets/js/11.0ec545d6.js"><link rel="prefetch" href="/fed-doc/assets/js/12.02c16ef5.js"><link rel="prefetch" href="/fed-doc/assets/js/13.6ac43ad1.js"><link rel="prefetch" href="/fed-doc/assets/js/14.d408c93e.js"><link rel="prefetch" href="/fed-doc/assets/js/15.4f0d59db.js"><link rel="prefetch" href="/fed-doc/assets/js/17.f507f9c3.js"><link rel="prefetch" href="/fed-doc/assets/js/18.22dfb34c.js"><link rel="prefetch" href="/fed-doc/assets/js/19.2a3a415d.js"><link rel="prefetch" href="/fed-doc/assets/js/20.aa1492a8.js"><link rel="prefetch" href="/fed-doc/assets/js/21.c70552a9.js"><link rel="prefetch" href="/fed-doc/assets/js/22.f6b81080.js"><link rel="prefetch" href="/fed-doc/assets/js/23.a75caa1c.js"><link rel="prefetch" href="/fed-doc/assets/js/24.43c1f6cd.js"><link rel="prefetch" href="/fed-doc/assets/js/25.9b841371.js"><link rel="prefetch" href="/fed-doc/assets/js/26.468e842a.js"><link rel="prefetch" href="/fed-doc/assets/js/27.6c7a709f.js"><link rel="prefetch" href="/fed-doc/assets/js/28.a52990ba.js"><link rel="prefetch" href="/fed-doc/assets/js/29.f54cd8f7.js"><link rel="prefetch" href="/fed-doc/assets/js/3.253f865d.js"><link rel="prefetch" href="/fed-doc/assets/js/4.4e7ec42f.js"><link rel="prefetch" href="/fed-doc/assets/js/5.80de3d18.js"><link rel="prefetch" href="/fed-doc/assets/js/6.e4efd90d.js"><link rel="prefetch" href="/fed-doc/assets/js/7.a425c80c.js"><link rel="prefetch" href="/fed-doc/assets/js/8.70b491c7.js"><link rel="prefetch" href="/fed-doc/assets/js/9.70ba6f78.js">
    <link rel="stylesheet" href="/fed-doc/assets/css/0.styles.79df93a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fed-doc/" class="home-link router-link-active"><!----> <span class="site-name">Fed-docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://10.10.1.2:7777/hekr-components/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hekr-components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://10.10.1.2:7777/auto/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auto
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/fed-doc/sdk/" class="nav-link">SDK</a></div><div class="nav-item"><a href="http://10.10.1.2:7777/layer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="http://gitlab.hekr.me/front-end/fed-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitLab
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://10.10.1.2:7777/hekr-components/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hekr-components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://10.10.1.2:7777/auto/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auto
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/fed-doc/sdk/" class="nav-link">SDK</a></div><div class="nav-item"><a href="http://10.10.1.2:7777/layer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="http://gitlab.hekr.me/front-end/fed-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitLab
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>一体化项目前端开发常见问题汇总</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#一体化项目前端开发常见问题汇总" class="sidebar-link">一体化项目前端开发常见问题汇总</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#多语言i18n" class="sidebar-link">多语言i18n</a></li><li class="sidebar-sub-header"><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#点击安卓返回键关闭弹层" class="sidebar-link">点击安卓返回键关闭弹层</a></li><li class="sidebar-sub-header"><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#v-chart组件chart-js配置" class="sidebar-link">v-chart组件chart.js配置</a></li><li class="sidebar-sub-header"><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#定时设置时判断是否与其他定时时段有重叠" class="sidebar-link">定时设置时判断是否与其他定时时段有重叠</a></li></ul></li><li><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#定时任务提示（非云端预约）" class="sidebar-link">定时任务提示（非云端预约）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#判断是否为首次进入控制页面" class="sidebar-link">判断是否为首次进入控制页面</a></li><li class="sidebar-sub-header"><a href="/fed-doc/%E6%B0%A6%E6%B0%AA%E4%B8%80%E4%BD%93%E5%8C%96%E5%BC%80%E5%8F%91%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93.html#ios端监听document的click事件失效解决方法" class="sidebar-link">iOS端监听document的click事件失效解决方法</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="一体化项目前端开发常见问题汇总"><a href="#一体化项目前端开发常见问题汇总" aria-hidden="true" class="header-anchor">#</a> 一体化项目前端开发常见问题汇总</h2> <blockquote><p>以下所列代码有很多地方可以优化，主要参考一下大致的解决思路就好了，若发现不对的地方请及时通知更正</p></blockquote> <h3 id="多语言i18n"><a href="#多语言i18n" aria-hidden="true" class="header-anchor">#</a> 多语言i18n</h3> <p>建议单独js文件用于保存对每种语言的配置，如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 中文配置：i18n-cn.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    sw<span class="token punctuation">:</span> <span class="token string">'开关'</span><span class="token punctuation">,</span>
    setting<span class="token punctuation">:</span> <span class="token string">'设置'</span><span class="token punctuation">,</span>
    cancel<span class="token punctuation">:</span> <span class="token string">'取消'</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">// 英文配置：i18n-en.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    sw<span class="token punctuation">:</span> <span class="token string">'Switch'</span><span class="token punctuation">,</span>
    setting<span class="token punctuation">:</span> <span class="token string">'Setting'</span><span class="token punctuation">,</span>
    cancel<span class="token punctuation">:</span> <span class="token string">'Cancel'</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后在main.js中引入：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> HekrComponents<span class="token punctuation">,</span> <span class="token punctuation">{</span> i18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@hekr/hekr-components'</span>
<span class="token keyword">import</span> i18nZhCN <span class="token keyword">from</span> <span class="token string">'@/assets/js/i18n-zh-CN'</span>
<span class="token keyword">import</span> i18nEnUS <span class="token keyword">from</span> <span class="token string">'@/assets/js/i18n-en-US'</span>

<span class="token comment">// ...</span>

i18n<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'zh-CN'</span><span class="token punctuation">:</span> i18nZhCN<span class="token punctuation">,</span>
    <span class="token string">'en-US'</span><span class="token punctuation">:</span> i18nEnUS
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// ...</span>
</code></pre></div><p>App.vue中根据系统语言自动选择使用哪个语音包</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$hekr<span class="token punctuation">.</span>app<span class="token punctuation">.</span>lang<span class="token punctuation">)</span>
</code></pre></div><p>使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
    <span class="token punctuation">.</span>switch <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">$i</span><span class="token punctuation">(</span><span class="token string">'sw'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Tips</strong>：应该注意在做多语言的项目时，代码中除了注释可以使用中文，其他地方都不应该直接出现中文，避免在其他语言环境下出现中文显示。</p> <h3 id="点击安卓返回键关闭弹层"><a href="#点击安卓返回键关闭弹层" aria-hidden="true" class="header-anchor">#</a> 点击安卓返回键关闭弹层</h3> <p>需求：当点击安卓返回键时，如果有弹出层（比如pop、dialog或者confirm等）时，应该关闭弹出层，而不是做路由返回跳转。</p> <p><strong>解决方法</strong>：</p> <ul><li>App控制页</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// App.vue</span>
<span class="token comment">// 安卓返回键点击</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$hekr<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'back'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$back<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$back<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'home'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$hekr<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>当打开一个弹层时会向this.$back队列中push一项，当安卓返回键点击时，判断如果back队列不是空数组时，说明存在弹层，那么将弹层关闭，便不做路由跳转。</p> <p>配合v-back指令使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>home
  hk<span class="token operator">-</span><span class="token function">pop</span><span class="token punctuation">(</span>v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;popVisible&quot;</span><span class="token punctuation">)</span>
    hk<span class="token operator">-</span><span class="token function">slider</span><span class="token punctuation">(</span>
      <span class="token comment">//...</span>
      v<span class="token operator">-</span>back<span class="token operator">=</span><span class="token string">&quot;popVisible&quot;</span>
    <span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><p>需求：在点击返回或者安卓返回键时要求弹出对话框提示保存修改。
可以参照如下方式解决：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>one<span class="token operator">-</span>key<span class="token operator">-</span>operate
  hk<span class="token operator">-</span><span class="token function">header</span><span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">&quot;一键操作&quot;</span>
    rightText<span class="token operator">=</span><span class="token string">&quot;保存&quot;</span>
    v<span class="token operator">-</span>back<span class="token operator">=</span><span class="token string">&quot;back&quot;</span>
    @click<span class="token operator">-</span>left<span class="token operator">=</span><span class="token string">&quot;back&quot;</span>
    @click<span class="token operator">-</span>right<span class="token operator">=</span><span class="token string">&quot;save&quot;</span>
  <span class="token punctuation">)</span>
  <span class="token comment">// ...</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token function">back</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$confirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token punctuation">:</span> <span class="token string">'温馨提示'</span><span class="token punctuation">,</span>
        text<span class="token punctuation">:</span> <span class="token string">'是否保存？'</span><span class="token punctuation">,</span>
        bodyTextAlign<span class="token punctuation">:</span> <span class="token string">'center'</span><span class="token punctuation">,</span>
        confirmText<span class="token punctuation">:</span> <span class="token string">'保存'</span><span class="token punctuation">,</span>
        cancelText<span class="token punctuation">:</span> <span class="token string">'不保存'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">save</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$hekr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>this<span class="token punctuation">.</span>allStatus<span class="token punctuation">,</span>
        cmdTag<span class="token punctuation">:</span> <span class="token string">'setAllStatus'</span><span class="token punctuation">,</span>
        cmdId<span class="token punctuation">:</span> <span class="token number">27</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><ul><li>微信控制页</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// App.vue</span>

<span class="token comment">// 安卓返回键点击</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$back<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$back<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// home.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
hk<span class="token operator">-</span><span class="token function">pop</span><span class="token punctuation">(</span>v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;circleTempPopVisible&quot;</span><span class="token punctuation">)</span>
  hk<span class="token operator">-</span><span class="token function">select</span><span class="token punctuation">(</span>
    v<span class="token operator">-</span>back<span class="token operator">=</span><span class="token string">&quot;circleTempPopVisible&quot;</span>
    title<span class="token operator">=</span><span class="token string">&quot;循环温度设置&quot;</span>
    v<span class="token operator">-</span>model<span class="token operator">=</span><span class="token string">&quot;circleTemp&quot;</span>
    <span class="token punctuation">:</span>items<span class="token operator">=</span><span class="token string">&quot;circleItems&quot;</span>
 <span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  computed<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 表示是否存在弹层</span>
    <span class="token function">popExisted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>circleTempPopVisible
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  watch<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听该值，如变为true说明存在弹出层</span>
    <span class="token comment">// 当点击安卓物理返回键时执行路由回退操作从而关闭弹出层</span>
    <span class="token comment">// 需配合v-back使用,以及在App.vue中监听路由钩子</span>
    <span class="token function">popExisted</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          path<span class="token punctuation">:</span> <span class="token string">'/?popExisted=true'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><h3 id="v-chart组件chart-js配置"><a href="#v-chart组件chart-js配置" aria-hidden="true" class="header-anchor">#</a> v-chart组件chart.js配置</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
<span class="token punctuation">.</span>chart
  hk<span class="token operator">-</span><span class="token function">chart</span><span class="token punctuation">(</span>
    v<span class="token operator">-</span>bind<span class="token operator">=</span><span class="token string">&quot;chart&quot;</span>
    <span class="token punctuation">:</span>data<span class="token operator">=</span><span class="token string">&quot;chartData&quot;</span>
    <span class="token punctuation">:</span>gradients<span class="token operator">=</span><span class="token string">&quot;gradients&quot;</span>
    <span class="token punctuation">:</span>loading<span class="token operator">=</span><span class="token string">&quot;loading&quot;</span>
<span class="token punctuation">)</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'chart'</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// chart配置</span>
      chart<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> <span class="token string">'line'</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          responsive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          maintainAspectRatio<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
          legend<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token comment">// display: false</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          elements<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            line<span class="token punctuation">:</span> <span class="token punctuation">{</span>
              tension<span class="token punctuation">:</span> <span class="token number">0.4</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          scales<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            xAxes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
              gridLines<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                borderDash<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                borderDashOffset<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                display<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                drawBorder<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                color<span class="token punctuation">:</span> <span class="token string">'rgba(0, 0, 0, 0.2)'</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              ticks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                fontColor<span class="token punctuation">:</span> <span class="token string">'#333'</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            yAxes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
              gridLines<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                borderDash<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                borderDashOffset<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
                display<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                drawBorder<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                color<span class="token punctuation">:</span> <span class="token string">'rgba(0, 0, 0, 0.2)'</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              ticks<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                min<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                fontColor<span class="token punctuation">:</span> <span class="token string">'#333'</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">]</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      gradients<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          pos<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          color<span class="token punctuation">:</span> <span class="token string">'rgba(213, 253, 255, 0.4)'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          pos<span class="token punctuation">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span>
          color<span class="token punctuation">:</span> <span class="token string">'rgba(213, 253, 255, 0.1)'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          pos<span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token punctuation">,</span>
          color<span class="token punctuation">:</span> <span class="token string">'rgba(213, 253, 250, 1)'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          pos<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
          color<span class="token punctuation">:</span> <span class="token string">'rgba(213, 253, , 1)'</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="定时设置时判断是否与其他定时时段有重叠"><a href="#定时设置时判断是否与其他定时时段有重叠" aria-hidden="true" class="header-anchor">#</a> 定时设置时判断是否与其他定时时段有重叠</h3> <p>结合具体情况可以参考以下判断思路：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 判断是否跨夜</span>
<span class="token function">isStepNight</span> <span class="token punctuation">(</span><span class="token parameter">start<span class="token punctuation">,</span> end</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>start<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">timeToMinutes</span> <span class="token punctuation">(</span><span class="token parameter">time</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>h <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> time<span class="token punctuation">.</span>m<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 判断定时时间段是否与其他时段重叠</span>
<span class="token function">hasCollapse</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 排除当前正在编辑的定时item</span>
  list <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> item<span class="token punctuation">.</span>id <span class="token operator">!==</span> target<span class="token punctuation">.</span>id
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> list<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 开机关机时间相同的类似00:00~00:00的情况不算重叠</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token comment">// 列表中已经存在跨天的情况</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isStepNight</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>onTime<span class="token punctuation">,</span> item<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isStepNight</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>onTime<span class="token punctuation">,</span> target<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 列表中不存在跨天的情况</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isStepNight</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>onTime<span class="token punctuation">,</span> target<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span> <span class="token operator">||</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>offTime<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">timeToMinutes</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>onTime<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><p>定时item的数据结构:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  title<span class="token punctuation">:</span> <span class="token string">'定时1'</span><span class="token punctuation">,</span>
  id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  onTime<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    h<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    m<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  offTime<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    h<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    m<span class="token punctuation">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  time<span class="token punctuation">:</span> <span class="token string">'00:00~00:00'</span><span class="token punctuation">,</span>
  temp<span class="token punctuation">:</span> <span class="token number">45</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="定时任务提示（非云端预约）"><a href="#定时任务提示（非云端预约）" aria-hidden="true" class="header-anchor">#</a> 定时任务提示（非云端预约）</h2> <p>需求：假如存在开启状态的定时任务，要求在首页显示即将触发的一次定时任务何时开启或关闭等提示信息。关键在于需要根据定时的开始时间和结束时间进行排序。</p> <p>如下可做一定参考：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">getTiming</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> tm1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> tm2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">const</span> tm3 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  tm1<span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOn_H1 <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOn_M1
  tm1<span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOff_H1 <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOff_M1
  tm1<span class="token punctuation">.</span>tmSw <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmSw1
  tm1<span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token number">1</span>

  tm2<span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOn_H2 <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOn_M2
  tm2<span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOff_H2 <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOff_M2
  tm2<span class="token punctuation">.</span>tmSw <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmSw2
  tm2<span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token number">2</span>

  tm3<span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOn_H3 <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOn_M3
  tm3<span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOff_H3 <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmOff_M3
  tm3<span class="token punctuation">.</span>tmSw <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>status<span class="token punctuation">.</span>tmSw3
  tm3<span class="token punctuation">.</span>flag <span class="token operator">=</span> <span class="token number">3</span>

  <span class="token keyword">const</span> newDate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> nowTime <span class="token operator">=</span> newDate<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">+</span> newDate<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">const</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

  arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>tm1<span class="token punctuation">,</span> tm2<span class="token punctuation">,</span> tm3<span class="token punctuation">)</span>
  arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span>tmSw <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>key<span class="token punctuation">.</span>start <span class="token operator">&gt;=</span> nowTime <span class="token operator">||</span> key<span class="token punctuation">.</span>end <span class="token operator">&gt;=</span> nowTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        arr2<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// 开始时间或者结束时间大于当前时间</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  arr2<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// 从小到大排序 arr[0]即为最近的时段</span>
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>start <span class="token operator">&gt;</span> b<span class="token punctuation">.</span>start
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr2<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> readyToOpen <span class="token operator">=</span> nowTime <span class="token operator">&lt;=</span> arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>start
    <span class="token keyword">this</span><span class="token punctuation">.</span>timingAction <span class="token operator">=</span> readyToOpen <span class="token operator">?</span> <span class="token string">'开启'</span> <span class="token punctuation">:</span> <span class="token string">'关闭'</span>
    <span class="token keyword">const</span> startTime <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">startTime</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">const</span> endTime <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">endTime</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>showTiming <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token keyword">return</span> readyToOpen
      <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forMatTime</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>startTime<span class="token punctuation">]</span><span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forMatTime</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>startTime<span class="token punctuation">]</span><span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
      <span class="token punctuation">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forMatTime</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>endTime<span class="token punctuation">]</span><span class="token punctuation">.</span>h<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> : </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">forMatTime</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">[</span>endTime<span class="token punctuation">]</span><span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>showTiming <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">return</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="判断是否为首次进入控制页面"><a href="#判断是否为首次进入控制页面" aria-hidden="true" class="header-anchor">#</a> 判断是否为首次进入控制页面</h3> <blockquote><p>在<code>App.vue</code>中<code>mounted</code>钩子中（<code>$hekr.ready</code>之前）从地址栏获取到<code>ctrlKey</code>，然后去<code>localstorage</code>中查询是否存在以<code>ctrlKey</code>为<code>key</code>存储的<code>devTid</code>，若不存在则说明为首次进入控制页，然后进行相应操作（比如跳转至向导页）。当用户进入控制页之后，需要做<code>devTid</code>的<code>localstorage</code>存储操作，之后进入<code>App.vue</code>中时便可查询到对应的<code>devTid</code>，从而可以判断出不是首次进入</p></blockquote> <h3 id="ios端监听document的click事件失效解决方法"><a href="#ios端监听document的click事件失效解决方法" aria-hidden="true" class="header-anchor">#</a> iOS端监听document的click事件失效解决方法</h3> <p>在html的样式中加上属性<code>cursor: pointer</code></p></div> <footer class="page-edit"><div class="edit-link"><a href="http://gitlab.hekr.me/front-end/fed-docs/edit/master/氦氪一体化开发问题总结.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">8/23/2018, 8:00:30 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/fed-doc/assets/js/app.e912bd36.js" defer></script><script src="/fed-doc/assets/js/2.03965f8c.js" defer></script><script src="/fed-doc/assets/js/16.82f80a83.js" defer></script>
  </body>
</html>
