# 丛云APP接口说明



## 1. 用户相关

### 1.1 注册

注册包括手机注册和邮箱注册

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/)

### 1.2 登录

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95)

### 1.3 重置密码

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E6%89%8B%E6%9C%BA%E5%8F%B7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E6%89%8B%E6%9C%BA%E5%8F%B7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81)

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E9%82%AE%E7%AE%B1%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E9%82%AE%E7%AE%B1%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81)

### 1.4 修改密码

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E6%97%A7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E4%BD%BF%E7%94%A8%E6%97%A7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81)

### 1.5 个人信息

获取用户信息：

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E6%A1%A3%E6%A1%88](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E6%A1%A3%E6%A1%88)

更新用户信息

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E6%A1%A3%E6%A1%88](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E6%9B%B4%E6%96%B0%E7%94%A8%E6%88%B7%E6%A1%A3%E6%A1%88)

### 1.6 上传图片

上传图片通用接口，应用在上传头像、反馈建议等页面。

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8/#%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6)

## 2. 设备管理

### 2.1 拉取设备列表

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/#%E5%88%97%E4%B8%BE%E8%AE%BE%E5%A4%87](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E7%AE%A1%E7%90%86/#%E5%88%97%E4%B8%BE%E8%AE%BE%E5%A4%87)

如 ` https://user-openapi.hekr.me/device?&page=0&size=20 `

## 3. 系统设置

### 3.1 消息中心

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E8%8E%B7%E5%8F%96%E6%8E%A8%E9%80%81%E5%8E%86%E5%8F%B2%E6%B6%88%E6%81%AF](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E8%8E%B7%E5%8F%96%E6%8E%A8%E9%80%81%E5%8E%86%E5%8F%B2%E6%B6%88%E6%81%AF)


如  `https://user-openapi.hekr.me/api/v1/app/push/history?size=20&page=0 `

### 3.2 常见问题

打开链接  `http://app.hekr.me/FAQ/index.html?clientType=IOS&lang=zh-CN&theme=1&version=1.8.5 `

参数说明：

```
①：IOS / ANDROID  
②：语言
    en-US--英文    
    zh-CN--中文    
③：主题
    0--夜间主题    
    1--蓝色主题    
    2--米黄色主题  
    3--绿色主题
④:App Name
    中文默认：云知屋
    英文默认：Wisen
```



### 3.3 反馈建议

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E4%BC%81%E4%B8%9AAPI/#%E9%92%88%E5%AF%B9%E8%AE%BE%E5%A4%87%E5%8F%8D%E9%A6%88%E9%97%AE%E9%A2%98](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E4%BC%81%E4%B8%9AAPI/#%E9%92%88%E5%AF%B9%E8%AE%BE%E5%A4%87%E5%8F%8D%E9%A6%88%E9%97%AE%E9%A2%98)


如 ` https://console-openapi.hekr.me/external/feedback `

### 3.4 用户协议

打开链接  `http://app.hekr.me/FAQ/user_protocol.html?lang=zh-CN` 

```
①：语言    
    en-US--英文    
    zh-CN--中文  默认值   

```



## 4.共享授权

### 4.1 简要说明

APP中使用的授权流程为“反向授权”。设备主A展示授权二维码，用户B打开APP，扫描A上的二维码

### 4.2 A生成授权二维码

接口地址： ` https://user-openapi.hekr.me/authorization/reverse/authUrl `

接口说明：
[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E5%88%9B%E5%BB%BA%E6%8E%88%E6%9D%83%E9%93%BE%E6%8E%A5%E4%BA%8C%E7%BB%B4%E7%A0%81](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E5%88%9B%E5%BB%BA%E6%8E%88%E6%9D%83%E9%93%BE%E6%8E%A5%E4%BA%8C%E7%BB%B4%E7%A0%81)


拿到“reverseAuthorizationTemplateId”，二维码内容格式可定义为“action=rauth&token={reverseAuthorizationTemplateId}”。

### 4.3 B扫描二维码

用户B扫描拿到二维码内容后，发起申请设备授权。

接口地址： [https://user-openapi.hekr.me/authorization/reverse/register?reverseTemplateId={reverseTemplateId}&grantee={uid} ](https://user-openapi.hekr.me/authorization/reverse/register?reverseTemplateId={reverseTemplateId}&grantee={uid} )

接口说明：
[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E7%94%B3%E8%AF%B7%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E7%94%B3%E8%AF%B7%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83)

注意，请求参数要加上uid，即用户B的uid。

### 4.4 A查看授权申请

A收到APP的推送消息。

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E6%8E%A8%E9%80%81%E6%B6%88%E6%81%AF/#%E7%94%B3%E8%AF%B7%E7%94%A8%E6%88%B7%E6%89%AB%E6%8F%8F%E6%8E%88%E6%9D%83%E7%A0%81%E5%B1%9E%E4%B8%BB%E6%94%B6%E5%88%B0%E6%8E%A8%E9%80%81](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E6%8E%A8%E9%80%81%E6%B6%88%E6%81%AF/#%E7%94%B3%E8%AF%B7%E7%94%A8%E6%88%B7%E6%89%AB%E6%8F%8F%E6%8E%88%E6%9D%83%E7%A0%81%E5%B1%9E%E4%B8%BB%E6%94%B6%E5%88%B0%E6%8E%A8%E9%80%81)


然后发起查询请求，弹出对话框，让用户选择“拒绝”还是“允许”。

查询接口：[https://user-openapi.hekr.me/authorization/reverse/register?page=0&size=1 ](https://user-openapi.hekr.me/authorization/reverse/register?page=0&size=1 ) 

接口说明：
[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E6%9F%A5%E7%9C%8B%E6%8E%88%E6%9D%83%E7%94%B3%E8%AF%B7%E8%AE%B0%E5%BD%95](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E6%9F%A5%E7%9C%8B%E6%8E%88%E6%9D%83%E7%94%B3%E8%AF%B7%E8%AE%B0%E5%BD%95)



同意授权：` POST https://user-openapi.hekr.me/authorization/reverse?devTid=ESP_2154&ctrlKey=d06310dac70&reverseRegisterId=fb725b0207:13113 `

拒绝授权：接口同上，POST改为DELETE。

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E5%90%8C%E6%84%8F%E6%8E%88%E6%9D%83%E7%94%B3%E8%AF%B7](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E5%90%8C%E6%84%8F%E6%8E%88%E6%9D%83%E7%94%B3%E8%AF%B7)




### 4.5 查看共享信息

[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E5%88%97%E4%B8%BE%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83/#%E5%88%97%E4%B8%BE%E8%AE%BE%E5%A4%87%E6%8E%88%E6%9D%83)


## 5. 推送配置

### 5.1 绑定推送标签

登录后需要发起绑定请求。

接口地址：`https://user-openapi.hekr.me/user/pushTagBind `

接口说明：
[http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E7%BB%91%E5%AE%9A%E6%8E%A8%E9%80%81%E6%A0%87%E7%AD%BE%E9%80%90%E4%B8%AA%E7%BB%91%E5%AE%9A](http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%94%A8%E6%88%B7API/#%E7%BB%91%E5%AE%9A%E6%8E%A8%E9%80%81%E6%A0%87%E7%AD%BE%E9%80%90%E4%B8%AA%E7%BB%91%E5%AE%9A)

参数示例：

```
{
	"locale": "zh_CN",
	"clientId": "76812e56e9186b2788d382fb937be4e6",
	"pushPlatform": "GETUI"
}
```

clientId由APP提供。

## 6. 其它接口

### 6.1 拉取位置天气

接口地址：[ https://user-openapi.hekr.me/external/now?location=30.274660:120.122529&sign=xxx&timestamp=1536916957642]( https://user-openapi.hekr.me/external/now?location=30.274660:120.122529&sign=xxx&timestamp=1536916957642) 