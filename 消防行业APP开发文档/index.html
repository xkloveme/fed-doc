<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>消防行业APP开发文档 | Fed-docs</title>
    <meta name="description" content="Hekr前端文档">
    
    
    <link rel="preload" href="/assets/css/0.styles.16e2754c.css" as="style"><link rel="preload" href="/assets/js/app.a4943324.js" as="script"><link rel="preload" href="/assets/js/2.03965f8c.js" as="script"><link rel="preload" href="/assets/js/6.e4efd90d.js" as="script"><link rel="prefetch" href="/assets/js/10.b8994720.js"><link rel="prefetch" href="/assets/js/11.0ec545d6.js"><link rel="prefetch" href="/assets/js/12.02c16ef5.js"><link rel="prefetch" href="/assets/js/13.6ac43ad1.js"><link rel="prefetch" href="/assets/js/14.d408c93e.js"><link rel="prefetch" href="/assets/js/15.4f0d59db.js"><link rel="prefetch" href="/assets/js/16.82f80a83.js"><link rel="prefetch" href="/assets/js/17.f507f9c3.js"><link rel="prefetch" href="/assets/js/18.22dfb34c.js"><link rel="prefetch" href="/assets/js/19.2a3a415d.js"><link rel="prefetch" href="/assets/js/20.aa1492a8.js"><link rel="prefetch" href="/assets/js/21.c70552a9.js"><link rel="prefetch" href="/assets/js/22.f6b81080.js"><link rel="prefetch" href="/assets/js/23.a75caa1c.js"><link rel="prefetch" href="/assets/js/24.43c1f6cd.js"><link rel="prefetch" href="/assets/js/25.9b841371.js"><link rel="prefetch" href="/assets/js/26.468e842a.js"><link rel="prefetch" href="/assets/js/27.6c7a709f.js"><link rel="prefetch" href="/assets/js/28.a52990ba.js"><link rel="prefetch" href="/assets/js/29.f54cd8f7.js"><link rel="prefetch" href="/assets/js/3.253f865d.js"><link rel="prefetch" href="/assets/js/4.4e7ec42f.js"><link rel="prefetch" href="/assets/js/5.80de3d18.js"><link rel="prefetch" href="/assets/js/7.a425c80c.js"><link rel="prefetch" href="/assets/js/8.70b491c7.js"><link rel="prefetch" href="/assets/js/9.70ba6f78.js">
    <link rel="stylesheet" href="/assets/css/0.styles.16e2754c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Fed-docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://10.10.1.2:7777/hekr-components/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hekr-components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://10.10.1.2:7777/auto/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auto
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/sdk/" class="nav-link">SDK</a></div><div class="nav-item"><a href="http://10.10.1.2:7777/layer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="http://gitlab.hekr.me/front-end/fed-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitLab
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://10.10.1.2:7777/hekr-components/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hekr-components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://10.10.1.2:7777/auto/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auto
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/sdk/" class="nav-link">SDK</a></div><div class="nav-item"><a href="http://10.10.1.2:7777/layer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="http://gitlab.hekr.me/front-end/fed-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitLab
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>消防行业APP开发文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#环境搭建" class="sidebar-link">环境搭建</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#目录结构" class="sidebar-link">目录结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#样式管理" class="sidebar-link">样式管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#命名规范" class="sidebar-link">命名规范</a></li></ul></li><li><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#项目备注" class="sidebar-link">项目备注</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#pid说明" class="sidebar-link">pid说明</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#下载链接" class="sidebar-link">下载链接</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#权限说明" class="sidebar-link">权限说明</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#用户类型说明" class="sidebar-link">用户类型说明</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#用户token说明" class="sidebar-link">用户Token说明</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#matrix说明" class="sidebar-link">Matrix说明</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#缓存信息说明" class="sidebar-link">缓存信息说明</a></li></ul></li><li><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#原生app交互matrix文档" class="sidebar-link">原生APP交互Matrix文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#安卓返回键" class="sidebar-link">安卓返回键</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#设置状态栏颜色" class="sidebar-link">设置状态栏颜色</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#获取clientid" class="sidebar-link">获取clientId</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#接收消息推送" class="sidebar-link">接收消息推送</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#收到消息声音提示" class="sidebar-link">收到消息声音提示</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#扫码二维码" class="sidebar-link">扫码二维码</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#获取手机图片" class="sidebar-link">获取手机图片</a></li></ul></li><li><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#功能逻辑讲解" class="sidebar-link">功能逻辑讲解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#注册功能" class="sidebar-link">注册功能</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#扫码绑定" class="sidebar-link">扫码绑定</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#消息推送" class="sidebar-link">消息推送</a></li><li class="sidebar-sub-header"><a href="/%E6%B6%88%E9%98%B2%E8%A1%8C%E4%B8%9AAPP%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/#websocket连接" class="sidebar-link">webSocket连接</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="消防行业app开发文档"><a href="#消防行业app开发文档" aria-hidden="true" class="header-anchor">#</a> 消防行业APP开发文档</h1> <blockquote><p>消防类行业APP开发总结，目前有海水湾APP、电可安APP(金控)、智慧用电APP(中科城安)</p></blockquote> <h2 id="环境搭建"><a href="#环境搭建" aria-hidden="true" class="header-anchor">#</a> 环境搭建</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 安装依赖</span>
<span class="token function">npm</span> <span class="token function">install</span>

<span class="token comment"># 启动本地服务（默认test环境接口） localhost:8080</span>
<span class="token function">npm</span> run dev

<span class="token comment"># 使用杭州环境本地调试</span>
<span class="token function">npm</span> run dev:hz

<span class="token comment"># 使用线上环境本地调试</span>
<span class="token function">npm</span> run dev:prod

<span class="token comment"># 打包杭州环境</span>
<span class="token function">npm</span> run build:hz

<span class="token comment"># 打包test环境</span>
<span class="token function">npm</span> run build:test

<span class="token comment"># 打包线上环境</span>
<span class="token function">npm</span> run build:prod
</code></pre></div><h2 id="目录结构"><a href="#目录结构" aria-hidden="true" class="header-anchor">#</a> 目录结构</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>src
├─ api               <span class="token comment"># api接口，按功能模块划分</span>
│    ├─ server       <span class="token comment"># 接口域名配置，环境有杭州环境、测试环境、线上环境</span>
│    ├─ device.js
│    ├─ login.js
│    └─ <span class="token punctuation">..</span>.
├─ assets            <span class="token comment"># 静态资源文件夹</span>
│    ├─ iconfont     <span class="token comment"># 字体图标</span>
│    ├─ images       <span class="token comment"># 图片</span>
│    ├─ stylus       <span class="token comment"># 样式</span>
│    └─ utils        <span class="token comment"># js脚本</span>
├─ components        <span class="token comment"># 组件</span>
├─ main.js           <span class="token comment"># 主要配置入口</span>
├─ permission.js     <span class="token comment"># 权限管理</span>
├─ router.js         <span class="token comment"># 路由</span>
├─ store             <span class="token comment"># VUEX</span>
├─ App.vue           <span class="token comment"># APP入口文件</span>
└─ views             <span class="token comment"># 各功能页面</span>
       ├─ <span class="token function">add</span>        <span class="token comment"># 扫码绑定成功或失败页面</span>
       ├─ device     <span class="token comment"># 设备详情控制页面</span>
       ├─ login      <span class="token comment"># 登陆、注册、忘记密码页面</span>
       ├─ message    <span class="token comment"># 消息中心页面</span>
       ├─ user       <span class="token comment"># 个人中心页面</span>
       └─ home       <span class="token comment"># 首页等等</span>
</code></pre></div><h2 id="样式管理"><a href="#样式管理" aria-hidden="true" class="header-anchor">#</a> 样式管理</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>stylus
├─ hekr.scss             <span class="token comment"># 自定义公共样式</span>
└─ color.scss            <span class="token comment"># 颜色变量</span>
</code></pre></div><h3 id="命名规范"><a href="#命名规范" aria-hidden="true" class="header-anchor">#</a> 命名规范</h3> <ul><li>自定义公共样式，统一使用<code>hekr-</code>命名</li> <li>自定义颜色变量，统一使用<code>$--hc-</code>命名</li></ul> <h2 id="项目备注"><a href="#项目备注" aria-hidden="true" class="header-anchor">#</a> 项目备注</h2> <h3 id="pid说明"><a href="#pid说明" aria-hidden="true" class="header-anchor">#</a> pid说明</h3> <ul><li>每个行业项目根据pid区分，pid从console上获取。</li> <li>目前海水湾测试环境和正式环境pid不同，注意区分。金控和中科城安线上和测试账号和pid相同。</li> <li>以后项目尽量保证测试环境和正式环境console账号和pid相同。</li> <li>pid在<code>src/store/state.js</code>中配置。</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 海水湾线上账号</span>
console: <span class="token number">18066313344</span>
pid: 01253583638

<span class="token comment"># 海水湾测试账号</span>
console: <span class="token number">15158854335</span>
pid: 01376787549

<span class="token comment"># 金控线上和测试账号</span>
console: <span class="token number">13736732828</span>
pid: 01998843645

<span class="token comment"># 中科城安线上和测试账号</span>
console: <span class="token number">1757566751</span>@qq.com
pid: 01316026796
</code></pre></div><h3 id="下载链接"><a href="#下载链接" aria-hidden="true" class="header-anchor">#</a> 下载链接</h3> <table><thead><tr><th>APP名称</th> <th>安卓测试</th> <th>iOS测试</th> <th>安卓线上</th> <th>iOS线上</th></tr></thead> <tbody><tr><td>海水湾</td> <td><a href="https://www.pgyer.com/LMZb" target="_blank" rel="noopener noreferrer">LMZb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/dQsc" target="_blank" rel="noopener noreferrer">dQsc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/m33a" target="_blank" rel="noopener noreferrer">m33a<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/M8xh" target="_blank" rel="noopener noreferrer">M8xh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr> <tr><td>电可安</td> <td><a href="https://www.pgyer.com/Y7Dq" target="_blank" rel="noopener noreferrer">Y7Dq<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/ixSF" target="_blank" rel="noopener noreferrer">ixSF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/hLmo" target="_blank" rel="noopener noreferrer">hLmo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/Uy9c" target="_blank" rel="noopener noreferrer">Uy9c<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr> <tr><td>中科城安</td> <td><a href="https://www.pgyer.com/ZgVE" target="_blank" rel="noopener noreferrer">ZgVE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/ErI4" target="_blank" rel="noopener noreferrer">ErI4<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/ZKE0" target="_blank" rel="noopener noreferrer">ZKE0<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td> <td><a href="https://www.pgyer.com/3IRE" target="_blank" rel="noopener noreferrer">3IRE<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></td></tr></tbody></table> <h3 id="权限说明"><a href="#权限说明" aria-hidden="true" class="header-anchor">#</a> 权限说明</h3> <p>APP主要用到下列四个权限：</p> <ol><li><code>device$operation</code>: 设备操作权限，包括扫码绑定设备和修改设备信息。无权限对页面影响：首页无扫码图标，设备详情页无编辑图标。</li> <li><code>device$control</code>: 设备控制权限。无权对页面影响：控制页控制按钮隐藏。</li> <li><code>device$delete</code>: 设备删除权限。无权对页面影响：首页列表不能左滑。</li> <li><code>warning$handle</code>: 告警处理权限。无权对页面影响：告警和故障消息页面无处理按钮。</li></ol> <h3 id="用户类型说明"><a href="#用户类型说明" aria-hidden="true" class="header-anchor">#</a> 用户类型说明</h3> <ul><li>用户分为普通用户和后台分配账号。</li> <li>普通用户是在APP上注册的用户，后台分配账号由管理后台分配产生。</li> <li>根据用户信息中是否由<code>enterprise</code>字段来区分。</li></ul> <h3 id="用户token说明"><a href="#用户token说明" aria-hidden="true" class="header-anchor">#</a> 用户Token说明</h3> <ul><li>用户登陆token使用<code>localstrage</code>存储，<code>access_token</code>24小时过期，<code>refresh_token</code>30天过期。</li> <li>app用户不手动退出，打开app都要保持登陆状态。</li> <li>存储的key值在<code>src/store/state.js</code>里修改，注意每个项目key值修改一下。</li></ul> <h3 id="matrix说明"><a href="#matrix说明" aria-hidden="true" class="header-anchor">#</a> Matrix说明</h3> <ul><li><code>src/assets/utils/matrix.js</code>文件是在开发环境中使用，模拟调用APP接口方法。</li> <li>打包之后可通过<code>window.Matrix</code>获取APP方法。</li></ul> <h3 id="缓存信息说明"><a href="#缓存信息说明" aria-hidden="true" class="header-anchor">#</a> 缓存信息说明</h3> <ul><li>用户登陆token信息。</li> <li>安装位置和所属地址信息。绑定设备成功页面会从获取上一次绑定设备的安装位置和所属地址。</li> <li>clientId信息。一旦获取到clientId就存储起来，下次打开app的时候先从缓存读取绑定。</li> <li>缓存的key值统一在<code>src/store/state.js</code>中修改。</li></ul> <h2 id="原生app交互matrix文档"><a href="#原生app交互matrix文档" aria-hidden="true" class="header-anchor">#</a> 原生APP交互<a href="/matrix.html">Matrix文档</a></h2> <h3 id="安卓返回键"><a href="#安卓返回键" aria-hidden="true" class="header-anchor">#</a> 安卓返回键</h3> <ul><li>安卓返回的时候会调用一次 <code>Matrix.back()</code> 方法。</li> <li>最初back方法是个空函数，可以在<code>APP.vue</code>中重置back方法。</li></ul> <h3 id="设置状态栏颜色"><a href="#设置状态栏颜色" aria-hidden="true" class="header-anchor">#</a> 设置状态栏颜色</h3> <ul><li>使用 <code>Matrix.setStatusBarColor(color)</code> 设置状态栏颜色。</li> <li>最初启动页时候的状态栏是app默认的，如果要修改需要app配合。</li></ul> <h3 id="获取clientid"><a href="#获取clientid" aria-hidden="true" class="header-anchor">#</a> 获取clientId</h3> <ul><li>APP收到推送消息需要绑定当前clientId, 退出登陆后要解绑。</li> <li><code>Matrix.getClientId()</code> 会返回当前clientId, 但一般情况在<code>app.vue</code>中还获取不到clientId, 需要监听 <code>getClientId</code>事件。</li></ul> <h3 id="接收消息推送"><a href="#接收消息推送" aria-hidden="true" class="header-anchor">#</a> 接收消息推送</h3> <ul><li>监听 <code>onNotification</code> 事件获取消息内容。</li> <li>消息类型目前使用的有：强绑（<code>DEVICE_FORCEBIND</code>）、告警故障（<code>DEVICE_ALERT</code>）、系统消息。</li> <li>目前处理方式是：除了强绑消息弹框展示被绑定信息外，其他消息都确认跳转到消息中心页面。</li> <li>开发环境中可以使用 <code>Matrix.sendMessage(type)</code> 模拟发送消息。</li></ul> <h3 id="收到消息声音提示"><a href="#收到消息声音提示" aria-hidden="true" class="header-anchor">#</a> 收到消息声音提示</h3> <ul><li>收到消息通知的时候可以使用 <code>Matrix.alert()</code> 添加提示声音。</li> <li>目前只有金控APP使用声音。</li></ul> <h3 id="扫码二维码"><a href="#扫码二维码" aria-hidden="true" class="header-anchor">#</a> 扫码二维码</h3> <ul><li>通过 <code>Matrix.scanQRCode(key)</code> 调用扫描二维码。</li> <li>通过监听 <code>qrcode</code> 获取扫描结果。</li></ul> <h3 id="获取手机图片"><a href="#获取手机图片" aria-hidden="true" class="header-anchor">#</a> 获取手机图片</h3> <ul><li>通过 <code>Matrix.takePhoto(key, max)</code> 获取手机图片，max为最多可选几张图片。</li> <li>通过监听 <code>photo</code> 获取图片信息。</li></ul> <h2 id="功能逻辑讲解"><a href="#功能逻辑讲解" aria-hidden="true" class="header-anchor">#</a> 功能逻辑讲解</h2> <h3 id="注册功能"><a href="#注册功能" aria-hidden="true" class="header-anchor">#</a> 注册功能</h3> <p>APP仅支持手机号注册，具体接口文档阅读<a href="http://docs.hekr.me/v4/%E4%BA%91%E7%AB%AFAPI/%E7%99%BB%E5%BD%95%E6%B3%A8%E5%86%8C/#%E6%89%8B%E6%9C%BA%E6%B3%A8%E5%86%8C" target="_blank" rel="noopener noreferrer">注册接口<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="扫码绑定"><a href="#扫码绑定" aria-hidden="true" class="header-anchor">#</a> 扫码绑定</h3> <ul><li>绑定类型分为两类：一是根据devTid和bindKey绑定，二是根据短码和短码密码进行绑定。根据二维码返回的结果来区分。</li> <li>绑定根据用户类型有所区分：普通用户获取到信息后直接绑定，后台分配账号先查询设备状态再进行绑定。</li></ul> <p>绑定逻辑见下图</p> <p><img src="/assets/img/bind2.bae56cd3.png" alt="bind"></p> <h3 id="消息推送"><a href="#消息推送" aria-hidden="true" class="header-anchor">#</a> 消息推送</h3> <ul><li>打开APP先从缓存读取clientId, 如果缓存没有，通过<code>Matrix.getClientId()</code>获取，全局监听 <code>getClientId</code> 事件获取app传过来的clientId进行绑定。</li> <li>推送类型有：个推（GETUI)、小米（XIAOMI）、华为（HUAWEI）</li> <li>手动退出及时解绑。</li></ul> <h3 id="websocket连接"><a href="#websocket连接" aria-hidden="true" class="header-anchor">#</a> webSocket连接</h3> <ul><li>使用web版sdk建立连接通信，创建方法：<code>new HS.Matrix()</code>，项目中在 <code>src/permissions.js</code> 创建。</li> <li>进入不同设备页面使用 <code>setToken</code> 方法更新控制token。</li> <li>使用 <code>new HS.Hekr()</code> 创建Hekr，需要传入 <code>devTid</code> 和 <code>Matrix</code> 对象。</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="http://gitlab.hekr.me/front-end/fed-docs/edit/master/消防行业APP开发文档/README.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">10/30/2018, 6:59:51 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a4943324.js" defer></script><script src="/assets/js/2.03965f8c.js" defer></script><script src="/assets/js/6.e4efd90d.js" defer></script>
  </body>
</html>
