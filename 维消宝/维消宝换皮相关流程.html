<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>维消宝换皮相关流程 | Fed-docs</title>
    <meta name="description" content="Hekr前端文档">
    
    
    <link rel="preload" href="/fed-doc/assets/css/0.styles.79df93a7.css" as="style"><link rel="preload" href="/fed-doc/assets/js/app.e912bd36.js" as="script"><link rel="preload" href="/fed-doc/assets/js/2.03965f8c.js" as="script"><link rel="preload" href="/fed-doc/assets/js/19.2a3a415d.js" as="script"><link rel="prefetch" href="/fed-doc/assets/js/10.b8994720.js"><link rel="prefetch" href="/fed-doc/assets/js/11.0ec545d6.js"><link rel="prefetch" href="/fed-doc/assets/js/12.02c16ef5.js"><link rel="prefetch" href="/fed-doc/assets/js/13.6ac43ad1.js"><link rel="prefetch" href="/fed-doc/assets/js/14.d408c93e.js"><link rel="prefetch" href="/fed-doc/assets/js/15.4f0d59db.js"><link rel="prefetch" href="/fed-doc/assets/js/16.82f80a83.js"><link rel="prefetch" href="/fed-doc/assets/js/17.f507f9c3.js"><link rel="prefetch" href="/fed-doc/assets/js/18.22dfb34c.js"><link rel="prefetch" href="/fed-doc/assets/js/20.aa1492a8.js"><link rel="prefetch" href="/fed-doc/assets/js/21.c70552a9.js"><link rel="prefetch" href="/fed-doc/assets/js/22.f6b81080.js"><link rel="prefetch" href="/fed-doc/assets/js/23.a75caa1c.js"><link rel="prefetch" href="/fed-doc/assets/js/24.43c1f6cd.js"><link rel="prefetch" href="/fed-doc/assets/js/25.9b841371.js"><link rel="prefetch" href="/fed-doc/assets/js/26.468e842a.js"><link rel="prefetch" href="/fed-doc/assets/js/27.6c7a709f.js"><link rel="prefetch" href="/fed-doc/assets/js/28.a52990ba.js"><link rel="prefetch" href="/fed-doc/assets/js/29.f54cd8f7.js"><link rel="prefetch" href="/fed-doc/assets/js/3.253f865d.js"><link rel="prefetch" href="/fed-doc/assets/js/4.4e7ec42f.js"><link rel="prefetch" href="/fed-doc/assets/js/5.80de3d18.js"><link rel="prefetch" href="/fed-doc/assets/js/6.e4efd90d.js"><link rel="prefetch" href="/fed-doc/assets/js/7.a425c80c.js"><link rel="prefetch" href="/fed-doc/assets/js/8.70b491c7.js"><link rel="prefetch" href="/fed-doc/assets/js/9.70ba6f78.js">
    <link rel="stylesheet" href="/fed-doc/assets/css/0.styles.79df93a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fed-doc/" class="home-link router-link-active"><!----> <span class="site-name">Fed-docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://10.10.1.2:7777/hekr-components/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hekr-components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://10.10.1.2:7777/auto/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auto
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/fed-doc/sdk/" class="nav-link">SDK</a></div><div class="nav-item"><a href="http://10.10.1.2:7777/layer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="http://gitlab.hekr.me/front-end/fed-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitLab
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://10.10.1.2:7777/hekr-components/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Hekr-components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="http://10.10.1.2:7777/auto/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Auto
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/fed-doc/sdk/" class="nav-link">SDK</a></div><div class="nav-item"><a href="http://10.10.1.2:7777/layer/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  layer
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="http://gitlab.hekr.me/front-end/fed-docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitLab
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>维消宝换皮相关流程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fed-doc/%E7%BB%B4%E6%B6%88%E5%AE%9D/%E7%BB%B4%E6%B6%88%E5%AE%9D%E6%8D%A2%E7%9A%AE%E7%9B%B8%E5%85%B3%E6%B5%81%E7%A8%8B.html#起步" class="sidebar-link">起步</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fed-doc/%E7%BB%B4%E6%B6%88%E5%AE%9D/%E7%BB%B4%E6%B6%88%E5%AE%9D%E6%8D%A2%E7%9A%AE%E7%9B%B8%E5%85%B3%E6%B5%81%E7%A8%8B.html#项目的梳理" class="sidebar-link">项目的梳理</a></li></ul></li><li><a href="/fed-doc/%E7%BB%B4%E6%B6%88%E5%AE%9D/%E7%BB%B4%E6%B6%88%E5%AE%9D%E6%8D%A2%E7%9A%AE%E7%9B%B8%E5%85%B3%E6%B5%81%E7%A8%8B.html#fork-项目" class="sidebar-link">fork 项目</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/fed-doc/%E7%BB%B4%E6%B6%88%E5%AE%9D/%E7%BB%B4%E6%B6%88%E5%AE%9D%E6%8D%A2%E7%9A%AE%E7%9B%B8%E5%85%B3%E6%B5%81%E7%A8%8B.html#clone-项目" class="sidebar-link">clone 项目</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="维消宝换皮相关流程"><a href="#维消宝换皮相关流程" aria-hidden="true" class="header-anchor">#</a> 维消宝换皮相关流程</h1> <blockquote><p>为了更快接触了解维消宝项目换皮相关流程</p></blockquote> <div class="danger custom-block"><p class="custom-block-title">重要</p> <p>我们在换皮项目时一律用<kbd>fork</kbd>方式，虽然比新建分支过程麻烦一点，但不至于污染主仓库代码</p></div> <p></p><div class="table-of-contents"><ul><li><a href="#维消宝换皮相关流程">维消宝换皮相关流程</a><ul><li><a href="#起步">起步</a></li><li><a href="#fork-项目">fork 项目</a></li><li><a href="#clone-项目">clone 项目</a></li></ul></li></ul></div><p></p> <h2 id="起步"><a href="#起步" aria-hidden="true" class="header-anchor">#</a> 起步</h2> <div class="tip custom-block"><p class="custom-block-title">初衷</p> <p>现在换皮流程比较混乱加之维消宝项目分支越来越多，导致<code>.git</code>文件很大<kbd>clone</kbd>时需要比较久的时间，特有此文档</p></div> <h3 id="项目的梳理"><a href="#项目的梳理" aria-hidden="true" class="header-anchor">#</a> 项目的梳理</h3> <p>我们在登录<code>gitlab</code>后存在三种项目组</p> <ul><li><input type="checkbox" id="checkbox62" checked="checked"><label for="checkbox62">个人的项目</label></li> <li><input type="checkbox" id="checkbox63" checked="checked"><label for="checkbox63">行业解决方案</label></li> <li><input type="checkbox" id="checkbox64" checked="checked"><label for="checkbox64">氦氪一体化</label></li></ul> <h2 id="fork-项目"><a href="#fork-项目" aria-hidden="true" class="header-anchor">#</a> <code>fork</code> 项目</h2> <ol><li><p>我们在维消宝项目中点击<kbd>派生</kbd> <img src="https://s2.ax1x.com/2019/05/06/EBz1Ag.png" alt="EBz1Ag.png"></p></li> <li><p>选中<code>fork</code>到氦氪一体化
<img src="https://s2.ax1x.com/2019/05/06/EBzY3n.png" alt="EBzY3n.png"></p></li> <li><p>删除多余分支只留<code>master</code>分支，删除多余标签
<img src="https://s2.ax1x.com/2019/05/06/EDSlKx.png" alt="EDSlKx.png"></p></li> <li><p>更改库的名称和 <code>logo</code> <img src="https://s2.ax1x.com/2019/05/06/EDSC2n.png" alt="EDSC2n.png"> <img src="https://s2.ax1x.com/2019/05/06/EDSkrV.png" alt="EDSkrV.png"></p></li> <li><p>更改更为简洁的 ci，以明日电器为例：</p></li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code>cache:
  paths:
    - node_modules/

部署到预发:
  script:
    - <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>http://npm.hekr.me
    - <span class="token function">npm</span> run build:test
    - <span class="token function">sh</span> deploy.sh hekr-hangye/xiaofang-tomorrow-electrical-test/web
  tags:
    - <span class="token builtin class-name">test</span>
  only:
    - master
  when: manual
  environment:
    name: env-test
    url: https://hy.hekr.me/xiaofang-tomorrow-electrical-test/web/index.html

部署到线上:
  script:
    - <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>http://npm.hekr.me
    - <span class="token function">npm</span> run build:prod
    - <span class="token function">sh</span> deploy.sh hekr-hangye/xiaofang-tomorrow-electrical/web
  tags:
    - <span class="token builtin class-name">test</span>
  only:
    - master
  when: manual
  environment:
    name: env-prod
    url: https://hy.hekr.me/xiaofang-tomorrow-electrical/web/index.html

</code></pre></div><h2 id="clone-项目"><a href="#clone-项目" aria-hidden="true" class="header-anchor">#</a> <code>clone</code> 项目</h2> <ol><li>在克隆一份项目到本地</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone git@gitlab.hekr.me:web-app/weixiaobao-tomorrow-electrical.git
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>当并不需要进行深度克隆时可以添加参数</p></div> <ul><li>最近五次提交</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone git@gitlab.hekr.me:web-app/weixiaobao-tomorrow-electrical.git --depth<span class="token operator">=</span><span class="token number">5</span>
</code></pre></div><ul><li>单一<code>master</code>分支</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> clone git@gitlab.hekr.me:web-app/weixiaobao-tomorrow-electrical.git -b master --single-branch
</code></pre></div><ol start="2"><li>添加远程<code>root</code></li></ol> <blockquote><p>查看当前<code>remote</code></p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> remote -v
</code></pre></div><p><img src="https://s2.ax1x.com/2019/05/06/EDpDp9.png" alt="EDpDp9.png"></p> <blockquote><p>添加<code>root</code>源</p></blockquote> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> remote <span class="token function">add</span> root git@gitlab.hekr.me:industry-solutions/xiaofang-web.git
</code></pre></div><p><img src="https://s2.ax1x.com/2019/05/06/EDp5pd.png" alt="EDp5pd.png"></p> <ol start="3"><li>同步远程代码</li></ol> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">git</span> fetch root master
<span class="token function">git</span> merge root/master --no-f
</code></pre></div><p><code>--no-ff</code> 指的是强行关闭 <code>fast-forward</code> 方式</p> <p><code>fast-forward</code>方式就是当条件允许的时候，<code>git</code>直接把<code>HEAD</code>指针指向合并分支的头，完成合并。属于“快进方式”，不过这种情况如果删除分支，则会丢失分支信息。因为在这个过程中没有创建<code>commit</code></p> <p><code>git merge --squash</code> 是用来把一些不必要<code>commit</code>进行压缩，比如说，你的<code>feature</code>在开发的时候写的<code>commit</code>很乱，那么我们合并的时候不希望把这些历史<code>commit</code>带过来，于是使用<code>--squash</code>进行合并，此时文件已经同合并后一样了，但不移动 <code>HEAD</code>，不提交。需要进行一次额外的<code>commit</code>来“总结”一下，然后完成最终的合并</p> <p>总结：</p> <ul><li><p><code>--no-ff</code>：不使用 <code>fast-forward</code> 方式合并，保留分支的 <code>commit</code> 历史</p></li> <li><p><code>--squash</code>：使用 <code>squash</code> 方式合并，把多次分支 <code>commit</code> 历史压缩为一次</p></li></ul> <p><img src="https://s2.ax1x.com/2019/05/06/ED94ET.png" alt="ED94ET.png"></p></div> <footer class="page-edit"><div class="edit-link"><a href="http://gitlab.hekr.me/front-end/fed-docs/edit/master/维消宝/维消宝换皮相关流程.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">5/6/2019, 7:40:22 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/fed-doc/assets/js/app.e912bd36.js" defer></script><script src="/fed-doc/assets/js/2.03965f8c.js" defer></script><script src="/fed-doc/assets/js/19.2a3a415d.js" defer></script>
  </body>
</html>
